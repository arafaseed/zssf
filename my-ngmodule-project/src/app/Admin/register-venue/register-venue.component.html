<div class="max-w-3xl px-4 mx-auto mt-8">
  <!-- fullscreen spinner overlay -->
  <div *ngIf="isSubmitting" class="fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur">
    <div class="loader"></div>
  </div>

  <div class="p-6 bg-white shadow-lg rounded-2xl">
    <h3 class="mb-6 text-2xl font-semibold text-center text-slate-800">
      {{ isEditing ? 'Edit Venue' : 'Register New Venue' }}
    </h3>

    <form [formGroup]="venueForm" (ngSubmit)="onSubmit()" novalidate>
      <!-- Row: name + capacity -->
      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <div>
          <label class="block mb-1 text-sm font-medium text-slate-700">Venue Name</label>
          <input formControlName="venueName" class="w-full px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200" placeholder="Enter Venue Name" />
          <div *ngIf="venueForm.get('venueName')?.invalid && (venueForm.get('venueName')?.touched || submitted)" class="mt-1 text-sm text-rose-600">Venue Name is required</div>
        </div>

        <div>
          <label class="block mb-1 text-sm font-medium text-slate-700">Capacity</label>
          <input type="number" formControlName="capacity" class="w-full px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200" placeholder="Capacity" />
          <div *ngIf="venueForm.get('capacity')?.invalid && (venueForm.get('capacity')?.touched || submitted)" class="mt-1 text-sm text-rose-600">Capacity must be at least 1</div>
        </div>
      </div>

      <!-- Row: address + building -->
      <div class="grid grid-cols-1 gap-4 mt-4 md:grid-cols-2">
        <div>
          <label class="block mb-1 text-sm font-medium text-slate-700">Address</label>
          <input formControlName="address" class="w-full px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200" placeholder="Enter address (e.g. Room 001)" />
          <div *ngIf="venueForm.get('address')?.invalid && (venueForm.get('address')?.touched || submitted)" class="mt-1 text-sm text-rose-600">Address is required</div>
        </div>

        <div>
          <label class="block mb-1 text-sm font-medium text-slate-700">Building</label>
          <select formControlName="buildingId" class="w-full px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200">
            <option value="">-- Select Building --</option>
            <option *ngFor="let b of buildings" [value]="b.buildingId">{{ b.buildingName }}</option>
          </select>
          <div *ngIf="venueForm.get('buildingId')?.invalid && (venueForm.get('buildingId')?.touched || submitted)" class="mt-1 text-sm text-rose-600">Building selection is required</div>
        </div>
      </div>

      <!-- Row: venueType + placeholder (optional) -->
      <div class="mt-4">
        <label class="block mb-1 text-sm font-medium text-slate-700">Venue type (optional)</label>
        <select formControlName="venueType" class="w-full px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200">
          <option value="">-- Select type --</option>
          <option *ngFor="let t of venueTypes" [value]="t">{{ t }}</option>
        </select>
      </div>

      <!-- Description input & chips -->
      <div class="mt-4">
        <label class="block mb-2 text-sm font-medium text-slate-700">Descriptions</label>

        <div class="flex gap-2">
          <input
  [(ngModel)]="descriptionInput"
  [ngModelOptions]="{standalone: true}"
  name="descriptionInput"
  class="flex-1 px-4 py-2 border rounded-lg border-slate-200 focus:ring-2 focus:ring-sky-200"
  placeholder="Add one description and press Add" />

          <button type="button" (click)="addDescription()" class="px-4 py-2 text-white rounded-lg bg-sky-600 hover:bg-sky-700">Add</button>
        </div>

        <div *ngIf="submitted && descriptionList.length === 0" class="mt-2 text-sm text-rose-600">At least one description is required</div>

        <!-- chips preview -->
        <div class="flex flex-wrap gap-2 mt-3">
          <ng-container *ngFor="let d of descriptionList; let i = index">
            <div class="flex items-center gap-2 px-3 py-1 text-sm rounded-full bg-slate-100">
              <span class="text-slate-700">{{ d }}</span>
              <button type="button" (click)="removeDescription(i)" class="leading-none text-rose-600 hover:text-rose-800">✕</button>
            </div>
          </ng-container>
        </div>
      </div>

      <!-- File upload + horizontal previews -->
      <div class="mt-6">
        <label class="block mb-2 text-sm font-medium text-slate-700">Images (3–10 required)</label>

        <div class="flex items-center gap-3">
          <input type="file" #fileInput (change)="onFileSelected($event)" multiple accept="image/*" class="hidden" />
          <button type="button" (click)="fileInput.click()" class="inline-flex items-center gap-2 px-4 py-2 text-white rounded-lg bg-emerald-600 hover:bg-emerald-700">
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Upload Images
          </button>

          <div class="ml-2 text-sm text-slate-600">
            <span *ngIf="selectedFiles.length === 0">No files selected</span>
            <span *ngIf="selectedFiles.length > 0">{{ selectedFiles.length }} file(s) selected</span>
          </div>
        </div>

        <div *ngIf="submitted && selectedFiles.length === 0" class="mt-2 text-sm text-rose-600">At least one image is required</div>

        <!-- Horizontal previews -->
        <div class="py-2 mt-4 overflow-x-auto">
          <div class="flex gap-3">
            <div *ngFor="let preview of imagePreviews; let i = index" class="relative overflow-hidden border rounded-lg w-28 h-28">
              <img [src]="preview" class="object-cover w-full h-full" />
              <button type="button" (click)="removeImage(i)" class="absolute flex items-center justify-center w-6 h-6 text-white rounded-full shadow -top-2 -right-2 bg-rose-600">
                ✕
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Buttons -->
      <div class="flex flex-wrap justify-start gap-4 mt-6">
        <button type="button" (click)="onCancel()" class="px-4 py-2 text-white rounded-lg bg-rose-600 hover:bg-rose-700">Cancel</button>
        <button type="submit" class="px-4 py-2 text-white rounded-lg bg-sky-600 hover:bg-sky-700">Submit</button>
      </div>
    </form>
  </div>
</div>
