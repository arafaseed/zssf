<!-- to-checkout.component.html -->
<div class="p-4 font-poppins">
  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-8">
    <mat-progress-spinner
      diameter="48"
      mode="indeterminate"
      class="mx-auto"
      aria-label="Loading bookings spinner">
    </mat-progress-spinner>
    <p class="mt-2 text-gray-500">Loading bookings…</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="!loading && errorMessage" class="text-center text-red-600 py-4">
    {{ errorMessage }}
  </div>

  <!-- “To Check Out” Card Grid -->
  <div *ngIf="!loading && !errorMessage"
       class="grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
    <mat-card
      *ngFor="let booking of bookings"
      class="bg-white rounded-lg shadow-2xl p-4 flex flex-col justify-between border-2 border-yellow-300"
    >
      <mat-card-header class="pb-2 rounded-xl bg-yellow-200">
        <div mat-card-avatar class="flex items-center justify-center rounded-md bg-yellow-400 w-12 h-12">
          <mat-icon class="text-yellow-700" aria-hidden="true">check_circle</mat-icon>
        </div>

        <mat-card-title class="text-xl font-semibold text-gray-800">
          {{ booking.venueName }}
        </mat-card-title>

        <mat-card-subtitle class="text-sm text-gray-500">
          <span class="mr-2"><strong>Booking Code:</strong></span>
          <span class="font-medium text-blue-900">{{ booking.bookingCode }}</span>

          <p class="mt-2 text-sm italic text-gray-700 ">
          <strong class="mr-2">Booked on:</strong> {{ booking.bookingDate | date:'mediumDate' }}
         </p>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content class="mt-2 text-gray-700">
        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">person</mat-icon>
          <strong>Customer:</strong>
          {{ booking.customer.customerName }} 
        </p>
        
         <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">phone</mat-icon>
          <strong>Mobile:</strong>
          {{ booking.customer.phoneNumber }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">play_circle</mat-icon>
          <strong>Start:</strong> {{ booking.startDate | date:'medium' }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">stop_circle</mat-icon>
          <strong>End:</strong> {{ booking.endDate | date:'medium' }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">inventory_2</mat-icon>
          <strong>Activity:</strong>
          {{ booking.venueActivityName}} ({{ booking.venueActivityPrice | currency:'TZS':'symbol' }})
        </p>

        <p class="text-gray-700">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">directions_run</mat-icon>
          <strong>Optional service:</strong> {{ booking.venueOptionalServiceName}} ({{ booking.venueOptionServicePrice | currency:'TZS':'symbol' }})
        </p>

        <p class="text-sm font-medium"
           [ngClass]="{
             'text-red-600': booking.bookingStatus  === 'EXPIRED',
            'text-blue-600': booking.bookingStatus  === 'IN_PROGRESS',
             'text-green-600': booking.bookingStatus  === 'COMPLETE',
             'text-yellow-600': booking.bookingStatus  === 'PENDING',
             'text-purple-600': booking.bookingStatus  === 'CANCELLED'
           }">
          <mat-icon class="align-middle mr-1"
                    [ngClass]="{
                      'text-red-600': booking.bookingStatus  === 'EXPIRED',
            'text-blue-600': booking.bookingStatus  === 'IN_PROGRESS',
             'text-green-600': booking.bookingStatus  === 'COMPLETE',
             'text-yellow-600': booking.bookingStatus  === 'PENDING',
             'text-purple-600': booking.bookingStatus  === 'CANCELLED'
                    }"
                    aria-hidden="true">lens</mat-icon>
          Status: {{ booking.bookingStatus }}
        </p>
      </mat-card-content>

      <mat-card-actions class="mt-4">
        <button
          mat-raised-button
          (click)="openCheckoutModal(booking)"
          class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 rounded-md transition flex items-center justify-center gap-2"
          aria-label="Open checkout modal"
        >
          <mat-icon class="text-white">exit_to_app</mat-icon>
          <span>Check Out</span>
        </button>
      </mat-card-actions>
    </mat-card>

    <!-- If no bookings to check out -->
    <div *ngIf="!bookings.length" class="col-span-full text-center py-8 text-gray-500">
      No bookings to check out.
    </div>
  </div>

  <!-- Modal Overlay (preserved exactly) -->
  <ng-container *ngIf="showModal">
    <div class="fixed inset-0 bg-[rgba(15,23,42,0.78)] backdrop-blur-md flex items-center justify-center z-50">
      <mat-card class="bg-white rounded-lg shadow-xl w-11/12 max-w-lg p-6">
        <app-checkout-modal
          [booking]="selectedBooking"
          [staffIdentification]="staffIdentification"
          (close)="closeModal()"
          (checkedOut)="onCheckedOut()"
        ></app-checkout-modal>
      </mat-card>
    </div>
  </ng-container>
</div>
