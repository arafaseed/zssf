<!-- cancelled-bookings.component.html -->
<div class="p-4 font-poppins">
  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center py-8">
    <mat-progress-spinner
      diameter="48"
      mode="indeterminate"
      class="mx-auto"
      aria-label="Loading cancelled bookings spinner">
    </mat-progress-spinner>
    <p class="mt-2 text-gray-500">Loading cancelled bookings…</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="!loading && errorMessage" class="text-center text-red-600 py-4">
    {{ errorMessage }}
  </div>

  <!-- Cards Grid -->
  <div *ngIf="!loading && !errorMessage" class="grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
    <!-- One card per cancelled booking -->
    <mat-card
      *ngFor="let booking of bookings"
      class="bg-white rounded-lg shadow-2xl p-4 flex flex-col justify-between border-2 border-red-300"
    >
      <mat-card-header class="pb-2 rounded-xl bg-red-200">
        <div mat-card-avatar class="flex items-center justify-center rounded-md bg-red-400 w-12 h-12">
          <mat-icon class="text-red-700">cancel</mat-icon>
        </div>

        <mat-card-title class="text-xl font-semibold text-gray-800">
          {{ booking.venueName }}
        </mat-card-title>

        <mat-card-subtitle class="text-sm text-gray-500">
          <span class="mr-2"><strong>Booking Code:</strong></span>
          <span class="font-medium text-blue-900">{{ booking.bookingCode }}</span>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content class="mt-2 text-gray-700">
        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">person</mat-icon>
          <strong>Customer:</strong>
          {{ booking.customer.customerName }} / {{ booking.customer.phoneNumber }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">play_circle</mat-icon>
          <strong>Start:</strong>
          {{ booking.startDate | date:'medium' }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">stop_circle</mat-icon>
          <strong>End:</strong>
          {{ booking.endDate | date:'medium' }}
        </p>

        <p class="mb-1">
          <mat-icon class="align-middle mr-2 text-gray-500" aria-hidden="true">inventory_2</mat-icon>
          <strong>Package:</strong>
          {{ booking.packageName }} ({{ booking.price | currency:'TZS':'symbol' }})
        </p>

        <!-- preserved commented activity line -->
        <!-- <p class="text-gray-700"><strong>Activity:</strong> {{ booking.activityName }}</p> -->

        <p class="text-gray-600 italic text-sm mt-2">
          <mat-icon class="align-middle mr-1 text-gray-400" aria-hidden="true">event</mat-icon>
          <strong>Booking Date:</strong> {{ booking.bookingDate | date:'mediumDate' }}
        </p>

        <p class="text-gray-600 italic text-sm">
          <mat-icon class="align-middle mr-1 text-gray-400" aria-hidden="true">schedule</mat-icon>
          <strong>Start:</strong> {{ booking.startDate | date:'mediumDate' }}
        </p>

        <p class="text-gray-600 italic text-sm mb-2">
          <mat-icon class="align-middle mr-1 text-gray-400" aria-hidden="true">event_busy</mat-icon>
          <strong>End:</strong>
          <span *ngIf="booking.endDate; else noEnd">{{ booking.endDate | date:'mediumDate' }}</span>
          <ng-template #noEnd>–</ng-template>
        </p>

        <p class="text-sm font-medium"
           [ngClass]="{
             'text-green-600': booking.status === 'COMPLETE',
             'text-red-600': booking.status === 'CANCELLED',
             'text-yellow-600': booking.status === 'PENDING'
           }">
          <mat-icon class="align-middle mr-1"
                    [ngClass]="{
                      'text-green-600': booking.status === 'COMPLETE',
                      'text-red-600': booking.status === 'CANCELLED',
                      'text-yellow-600': booking.status === 'PENDING'
                    }"
                    aria-hidden="true">lens</mat-icon>
          Status: {{ booking.status }}
        </p>
      </mat-card-content>
    </mat-card>

    <!-- No cancelled bookings -->
    <div *ngIf="!bookings.length" class="col-span-full text-center py-8 text-gray-500">
      No cancelled bookings found for this venue.
    </div>
  </div>
</div>
